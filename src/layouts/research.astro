---
import { SEO } from "astro-seo";
import NavBar from "../components/nav.tsx";
import "../globals.scss";
import '../styles/blog.scss'
import { Image } from 'astro:assets';
import signature from '../../public/signature-blue.png'
import FullColorFavi from '../img/2025/RM-monogram-black-on-transparent.svg'
import WhiteLogoFavi from '../img/2025/RM-monogram-white-on-transparent.svg'
import { ClientRouter } from 'astro:transitions';
import { availabilityStatus } from "../utils/statusIndicator";
import Footer from '../components/footer.svelte';

export interface Props {
  content: {
    title: string;
    author: string
    publishDate: string;
    wordCount: number;
    type: "IRR" | "IWA" | "Research";
    id: string
  };
}
const {
  content: {
    title,
    author,
    publishDate,
    wordCount,
    type,
    id
  },
} = Astro.props;

let typeLabel = "";
if (type === "IRR") {
  typeLabel = "Research Report";
} else if (type === "IWA") {
  typeLabel = "Written Argument";
} else if (type === "Research") {
  typeLabel = "Research Article";
}

---

<!DOCTYPE html>
<html lang="en">
  <head>
    <ClientRouter />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/2025/RM-monogram-black-on-transparent.svg" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={`${title} | Ryan Mullin Research`} />
    <script>
			function setBsDarkMode() {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.body.setAttribute('data-bs-theme', 'dark')
        } else {
          document.body.setAttribute('data-bs-theme', 'light')
        }
      }
      setBsDarkMode()
      document.addEventListener('astro:after-swap', setBsDarkMode)
		</script>
		<SEO 
			title={`${title} | Research | Ryan Mullin`}
			description={`${title} | Ryan Mullin Research`}
			noindex={false} 
			nofollow={false}
			openGraph={
				{
					basic: {
						title: `${title}`,
						type: "website",
						image: "/waves.png",
						url: Astro.request.url
					},
					optional: {
						description: title,
						locale: "en-US",
						siteName: "Ryan Mullin"
					},
					image: {
						alt: "colorful, wavy rainbow waves"
					}
				}
			}
		/>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@0;1&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- Animated cursor follower -->
    <div
      id="cursor-follower"
      class="pointer-events-none fixed inset-0 z-30 transition-opacity duration-300"
    />

    <nav class="p-10">
      <NavBar client:load>
        <Image 
          src={FullColorFavi} 
          alt='a double arrow' 
          style={{height: '3rem'}}
          class="logo-light"
        />
        <Image 
          src={WhiteLogoFavi} 
          alt='a double arrow' 
          style={{height: '3rem'}}
          class="logo-dark"
        />
      </NavBar>
    </nav>

    <main class="min-h-screen relative overflow-hidden">
      <!-- Hero Header Section -->
      <section class="px-6 md:px-12 pt-12 pb-8">
        <div class="max-w-5xl mx-auto w-full">
          <div class="space-y-6">
            <!-- Breadcrumb -->
            <a 
              href="/research" 
              class=""
            >
              <i class="bi bi-arrow-left transition-transform group-hover:-translate-x-1"></i>
              Back to Research
            </a>

            <!-- Type Badge -->
            <div class="inline-block">
              <span class="px-4 py-2 rounded-full border border-primary text-primary text-sm font-mono bg-blue-50 dark:bg-blue-950 dark:border-primary-dark dark:text-primary-dark">
                {typeLabel}
              </span>
            </div>

            <!-- Title -->
            <h1
              class="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight leading-tight"
              transition:name={title}
            >
              {title}
            </h1>

            <!-- Metadata -->
            <div class="flex flex-wrap items-center gap-4 text-gray-600 dark:text-neutral-200">
                <div class="flex items-center gap-3">
                <div class="h-px w-12 bg-primary dark:bg-primary-dark" />
                <span class="font-mono text-sm">
                  <span class="font-medium">{author || "Ryan Mullin"}</span>
                </span>
              </div>
              {publishDate && (
                <time datetime={publishDate} class="text-sm font-mono" transition:name={publishDate}>
                  Published {new Date(publishDate).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                  })}
                </time>
              )}
              <span class="text-sm font-mono text-gray-500 dark:text-neutral-300">
                {wordCount.toLocaleString()} words
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- Article Content -->
      <article class="px-6 md:px-12 pb-24 pt-8">
        <div class="max-w-4xl mx-auto w-full">
          <div class="prose prose-lg dark:prose-invert max-w-none
                      prose-headings:font-bold prose-headings:tracking-tight
                      prose-h1:text-4xl prose-h1:mt-12 prose-h1:mb-6
                      prose-h2:text-3xl prose-h2:mt-10 prose-h2:mb-5
                      prose-h3:text-2xl prose-h3:mt-8 prose-h3:mb-4
                      prose-p:text-gray-700 dark:prose-p:text-neutral-200 prose-p:leading-[1.8] prose-p:mb-6
                      prose-a:text-primary dark:prose-a:text-primary-dark prose-a:no-underline hover:prose-a:underline
                      prose-strong:text-gray-900 dark:prose-strong:text-gray-100 prose-strong:font-semibold
                      prose-em:italic
                      prose-code:text-primary dark:prose-code:text-primary-dark prose-code:bg-gray-100 dark:prose-code:bg-gray-800 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:font-mono prose-code:text-sm prose-code:before:content-none prose-code:after:content-none
                      prose-pre:bg-gray-900 prose-pre:border prose-pre:border-gray-700 prose-pre:rounded-xl
                      prose-img:rounded-xl prose-img:border prose-img:border-gray-200 dark:prose-img:border-gray-700 prose-img:mx-auto
                      prose-blockquote:border-l-4 prose-blockquote:border-primary dark:prose-blockquote:border-primary-dark prose-blockquote:pl-6 prose-blockquote:italic prose-blockquote:text-gray-600 dark:prose-blockquote:text-neutral-300
                      prose-ul:list-disc prose-ul:pl-6 prose-ul:space-y-2
                      prose-ol:list-decimal prose-ol:pl-6 prose-ol:space-y-2
                      prose-li:text-gray-700 dark:prose-li:text-neutral-200
                      prose-table:border-collapse prose-table:w-full
                      prose-th:border prose-th:border-neutral-200 dark:prose-th:border-gray-700 prose-th:bg-gray-100 dark:prose-th:bg-gray-800 prose-th:p-3 prose-th:text-left prose-th:font-semibold
                      prose-td:border prose-td:border-neutral-200 dark:prose-td:border-gray-700 prose-td:p-3
                      prose-hr:border-neutral-200 dark:prose-hr:border-gray-700
                      first-letter:text-6xl first-letter:font-bold first-letter:float-left first-letter:mr-3 first-letter:leading-none first-letter:font-serif first-letter:text-gray-900 dark:first-letter:text-gray-100"
            id="article"
          >
            <slot />
          </div>

          <!-- Signature -->
          <div class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700">
            <Image 
              src={signature} 
              alt="ryan mullin signature" 
              style={{ width: "16rem" }}
              class="opacity-80"
            />
          </div>

          <!-- Citation & Download Section -->
          <div class="mt-12 space-y-4">
            <div class="p-6 rounded-2xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50">
              <h3 class="font-mono text-sm text-gray-600 dark:text-neutral-300 mb-3">Cite This Work</h3>
              <p class="font-mono text-sm text-gray-700 dark:text-neutral-200 break-words">
                {author || "Ryan Mullin"}. ({publishDate ? new Date(publishDate).getFullYear() : "n.d."}). <em>{title}</em>. Retrieved from {Astro.request.url}
              </p>
            </div>

            <div class="flex items-center justify-between flex-wrap gap-4 p-6 rounded-2xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50">
              <p class="font-mono text-sm text-gray-600 dark:text-neutral-300">
                Share this research?
              </p>
              <div class="flex items-center gap-3 text-primary dark:text-primary-dark">
                <a
                  href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(Astro.request.url)}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="w-10 h-10 rounded-full border border-neutral-200 dark:border-gray-600 flex items-center justify-center hover:border-primary hover:text-primary dark:hover:border-primary-dark dark:hover:text-primary-dark transition-colors"
                  aria-label="Share on X"
                >
                  <i class="bi bi-twitter-x"></i>
                </a>
                <a
                  href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(Astro.request.url)}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="w-10 h-10 rounded-full border border-neutral-200 dark:border-gray-600 flex items-center justify-center hover:border-primary hover:text-primary dark:hover:border-primary-dark dark:hover:text-primary-dark transition-colors"
                  aria-label="Share on LinkedIn"
                >
                  <i class="bi bi-linkedin"></i>
                </a>
                <button
                  onclick="navigator.clipboard.writeText(window.location.href)"
                  class="w-10 h-10 rounded-full border border-neutral-200 dark:border-gray-600 flex items-center justify-center hover:border-primary hover:text-primary dark:hover:border-primary-dark dark:hover:text-primary-dark transition-colors"
                  aria-label="Copy link"
                >
                  <i class="bi bi-link"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </article>
    </main>
  

		<style>
			#pattern {
				background-size: cover;
				object-fit: fill;
				width: auto;
			}
		</style>

    <script>
      // Cursor follower effect
      const cursorFollower = document.getElementById('cursor-follower');
      
      const handleMouseMove = (e: MouseEvent) => {
        if (cursorFollower) {
          cursorFollower.style.background = `radial-gradient(400px at ${e.clientX}px ${e.clientY}px, rgba(3, 91, 255, 0.08), transparent 50%)`;
        }
      };

      window.addEventListener('mousemove', handleMouseMove);
    </script>
	</body>
</html>

<style>
  img {
    border-radius: 10px;
  }
</style>